<?
//$project_id=$model->project_id;
$lcount=levelcountfunc($project_id); 
$project_id=$_GET['project_id'];
$lcount=levelcountfunc($project_id);
//$lcount=$model->level_count;

if(!userprojectaccess($project_id))
{
?>
<div><font color="#FF0000" size="+5">You Dont have a Permissons to Access this Page</font></div>
<meta http-equiv="refresh" content="2;url='../../index.php'" />
<?
exit();
}
?>
<?  // all functions
$pro_d_qsns=projectviewfunc('1','1',$project_id);
$diciplinesdisply = discplinelistfunc();
?>

<h3><?php // echo $model->project_name ;?><span style="margin:800px;"></span></h3>
<div style="width:1010px;color:#f00; background-color:#dedede; margin-bottom:5px;padding:5px;" align="center" ><img border="0" src="<?php echo Yii::app()->request->baseUrl; ?>/images/mainlogo.gif"> </div>	
<div style="width:960px;display:table;background-color:#f1f1f1;padding:10px;">
	<div style="display:table;margin-bottom:10px;padding:5px;font-size:20px;">
		<div style="width:460px;float:left;color:#000000;"><strong>Project Name</strong></div>
		<div style="width:60px;float:left;color:#000000;">:</div>
		<div style="width:430px;float:left;color:#000000;"><?php  echo projectnamefunc($project_id);?></div>
     </div>   
	
	<div style="color:#f00; background-color:#dedede; margin-bottom:5px;padding:5px;"><strong>Project Details</strong> </div>		

	<div style="padding-left:20px;">
    <? 
	// project details
	foreach($pro_d_qsns as $p_key => $p_val) {
	 $q_id=$p_val['question_id'];
	 $p_array=mainquestion($q_id);
	 $question_type=$p_array['q_type'];
	 $question_content=$p_array['question'];
	 $ans_id=$p_array['a_type'];
	?>
	<div style="width:960px;display:table;">
	<!--<div style="display:none;">-->
		<div style="width:450px;float:left;"><? echo $question_content;?> </div>
	  <div style="width:60px;float:left;">:</div>
	  <div style="width:450px;float:left;"><?php echo  questionanswertypechefunc($q_id,$p_val['answer_dicsrption']);?></div>
	</div>
    
	<? } ?>
    </div>

		<div style="color:#f00; background-color:#dedede; margin-bottom:5px;padding:5px;"><strong>Project Disciplines</strong> </div>		

	  <div style="padding-left:20px;"><?
	  // project discplines
	   foreach($diciplinesdisply as $diskey => $disvalue) { 
        $pro_discp_id=$disvalue['id'];
		$pro_discp_name=$disvalue['name'];
	//	$pro_discp_qsns=projectviewfunc('1',$project_id);
	 	$p_discp_count=discplinecountfunc('1','2',$pro_discp_id,$project_id);
       if($p_discp_count >0) 
	   { 
	     $pro_d_qsns=projectview_dsicp_func('1','2',$pro_discp_id,$project_id); 
	?>	 

		<div style="color:#217C7E;"><strong><?php echo $pro_discp_name; ?></strong> </div>		

	 <? foreach($pro_d_qsns as $p_key => $p_val) {
	 $q_id=$p_val['question_id'];
	 $p_array=mainquestion($q_id);
	 $question_type=$p_array['q_type'];
	 $question_content=$p_array['question'];
	 $question_discp=$p_array['discipline_id'];
	 if($question_type=='2') {
	?>
		<!--<div>-->
	<div style="width:960px;display:table;padding-left:20px;">
		<div style="width:430px;float:left;"><? echo $question_content;?> </div>
	  <div style="width:60px;float:left;">:</div>
	  <div style="width:470px;float:left;"><?php echo  questionanswertypechefunc($q_id,$p_val['answer_dicsrption']);?></div>
	</div>
	   <? }  }  } 	} ?></div>
	  <div style="width:960px;display:table;">
		<div style="width:470px;float:left;color:#3399FF;"><strong>Level Count</strong> </div>
		<div style="width:60px;float:left;color:#3399FF;">: </div>
		<div style="width:430px;float:left;color:#3399FF;"><?php echo $lcount ;?></div>		
	</div>
  <?  for ($l = 1; $l <= $lcount; $l++){ 
   $slevelnamearray= QuestionAnswers::model()->find(array('condition'=>"project_id ='$project_id' and level_id='$l' and question_id='0' and room_id is null"));
  ?>
	   <div style="width:960px;display:table;">
		<div style="width:470px;float:left;color:#3399FF;"><strong>Level <? print $l;?> Name</strong> </div>
			<div style="width:60px;float:left;color:#3399FF;">: </div>
			<div style="width:430px;float:left;color:#3399FF;"><?php echo $slevelnamearray['answer_dicsrption'];?></div>		
	 	</div>

		<div style="color:#f00; background-color:#dedede; margin-bottom:5px;padding:5px;"><strong>Level <? print $l;?>  Details</strong> </div>

	 <div> <? // level more details
	     $l_md_qsns=levelviewfunc('2','1',$project_id,$l);
	//   $l_md_qsns=projectviewfunc('1','1',$project_id);
	     //print_r($l_md_qsns);
	    foreach($l_md_qsns as $l_m_key=>$l_m_val) {
		
		 $l_m_q_id=$l_m_val['question_id'];
		 $l_m_array=mainquestion($l_m_q_id);
		 $question_type=$l_m_array['q_type'];
		 $question_content=$l_m_array['question'];
		 $ans_id=$l_m_array['a_type'];
	?>
	<div style="width:960px;display:table;padding-left:20px;">
	<!--<div style="display:none;">-->
		<div style="width:450px;float:left;"><? echo $question_content;?> </div>
	  <div style="width:60px;float:left;">:</div>
	  <div  style="width:450px;float:left;"><?php echo  questionanswertypechefunc($l_m_q_id,$l_m_val['answer_dicsrption']);?></div>
	</div>
	  <? } ?></div>
	    

		<div style="color:#f00; background-color:#dedede; margin-bottom:5px;padding:5px;"><strong>Level <? print $l;?> Discplines</strong> </div>

	   <div style="padding-left:20px;"> <?
	  // level discplines
	   foreach($diciplinesdisply as $diskey => $disvalue) { 
        $l_discp_id=$disvalue['id'];
		$l_discp_name=$disvalue['name'];
		$l_discp_count=level_discplinecountfunc('2','2',$l_discp_id,$project_id,$l);
       if($l_discp_count >0) 
	   { 
	     $l_d_qsns=levelview_dsicp_func('2','2',$l_discp_id,$project_id,$l); 
	?>	 

		<div style="color:#217C7E;"><strong><?php echo $l_discp_name; ?></strong> </div>		

	 <? foreach($l_d_qsns as $p_key => $p_val) {
	 $q_id=$p_val['question_id'];
	 $p_array=mainquestion($q_id);
	 $question_type=$p_array['q_type'];
	 $question_content=$p_array['question'];
	 $question_discp=$p_array['discipline_id'];
	 if($question_type=='2') {
	?>
		<!--<div>-->
	<div style="width:960px;display:table;padding-left:20px;">
		<div style="width:430px;float:left;"><? echo $question_content;?> </div>
	  <div style="width:60px;float:left;">:</div>
	  <div  style="width:470px;float:left;"><?php echo  questionanswertypechefunc($q_id,$p_val['answer_dicsrption']);?></div>
	</div>
	   <? }  }  } 	} ?></div>
	
	 <?
	 // room count 
	 $rcount=roomcountfunc($project_id,$l);
	 ?>  
    <div style="width:960px;display:table;">
		<div style="width:470px;float:left;color:#3399FF;"><strong>Room Count</strong> </div>
	  <div style="width:60px;float:left;color:#3399FF;">:</div>
	  <div  style="width:430px;float:left;color:#3399FF;"><?php echo $rcount; ?></div>
	</div>
	 
	 <?  for ($r = 1; $r <= $rcount; $r++){ 
   $roomnamearray= QuestionAnswers::model()->find(array('condition'=>"project_id ='$project_id' and level_id='$l' and question_id='0' and room_id='$r'"));
  ?>
	 <div style="width:960px;display:table;">
		<div style="width:470px;float:left;color:#3399FF;"><strong>Room <? print $r;?>  Name</strong> </div>
			<div style="width:60px;float:left;color:#3399FF;">: </div>
			<div  style="width:430px;float:left;color:#3399FF;"><?php echo $roomnamearray['answer_dicsrption'];?></div>		
	</div> 
     
		<div style="color:#f00; background-color:#dedede; margin-bottom:5px;padding:5px;"><strong>Room <? print $r;?> Details</strong> </div>

	 <div><? // Room more details
	     $r_md_qsns=roomviewfunc('3','1',$project_id,$l,$r);
	//   $l_md_qsns=projectviewfunc('1','1',$project_id);
	     //print_r($l_md_qsns);
	    foreach($r_md_qsns as $r_m_key=>$r_m_val) {
		
		 $r_m_q_id=$r_m_val['question_id'];
		 $r_m_array=mainquestion($r_m_q_id);
		 $question_type=$r_m_array['q_type'];
		 $question_content=$r_m_array['question'];
		 $ans_id=$r_m_array['a_type'];
	?>
	<div style="width:960px;display:table;padding-left:20px;">
	<!--<div style="display:none;">-->
		<div style="width:450px;float:left;"><? echo $question_content;?> </div>
	  <div style="width:60px;float:left;">:</div>
	  <div  style="width:450px;float:left;"><?php echo  questionanswertypechefunc($r_m_q_id,$r_m_val['answer_dicsrption']);?></div>
	</div>
	  <? } ?></div>

		<div style="color:#f00; background-color:#dedede; margin-bottom:5px;padding:5px;"><strong>Room <? print $r;?> Discplines</strong> </div>

	   <div> <?
	  // room discplines
	   foreach($diciplinesdisply as $diskey => $disvalue) { 
        $r_discp_id=$disvalue['id'];
		$r_discp_name=$disvalue['name'];
	 	$r_discp_count=room_discplinecountfunc('3','2',$r_discp_id,$project_id,$l,$r);
       if($r_discp_count >0) 
	   { 
	     $l_d_qsns=roomview_dsicp_func('3','2',$pro_discp_id,$project_id,$l,$r); 
	?>	 

		<div style="color:#217C7E;"><strong><?php echo $r_discp_name; ?></strong> </div>		

	 <? foreach($l_d_qsns as $p_key => $p_val) {
	 $q_id=$p_val['question_id'];
	 $p_array=mainquestion($q_id);
	 $question_type=$p_array['q_type'];
	 $question_content=$p_array['question'];
	 $question_discp=$p_array['discipline_id'];
	 if($question_type=='2') {
	?>
		<!--<div>-->
	<div style="width:960px;display:table;padding-left:20px;">
		<div style="width:450px;float:left;"><? echo $question_content;?> </div>
	  <div style="width:60px;float:left;">:</div>
	  <div  style="width:450px;float:left;"><?php echo  questionanswertypechefunc($q_id,$p_val['answer_dicsrption']);?></div>
	</div>
	   <? }  }  } 	} ?></div>
	  
	  
	<? } ?>    
	    	
   <?  } ?>
</div>
	
